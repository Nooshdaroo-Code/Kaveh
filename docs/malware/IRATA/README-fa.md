
# IRATA  
نام IRATA به دسته وسیعی از تروجان های ایرانی اندرویدی اطلاق می گردد که با وجود معماری و پیاده سازی متفاوت، اهداف و عملکرد مشابهی دارند؛ با این وجود به دلیل نسبت دادن این نام به گونه های مختلف بدافزاری در طول زمان، IRATA را نمی توان یک گونه بدافزاری مشخص دانست.  

For English version of this document, [click here](https://github.com/Nooshdaroo-Code/Kaveh/blob/main/docs/malware/IRATA/README.md).  

این دسته از بدافزار ها از طریق دسترسی غیرمجاز به پیامک های قربانی، رمز های بانکی و احراز هویت دو مرحله ای او را به سرقت می برند. IRATA یکی از فعال ترین دسته های بدافزار در ایران است و معمولا تحت عنوان سرویس های دولتی و قضایی مانند ابلاغیه، یارانه، کالابرگ، همتا (رجیستری) و… اقدام به فریب کاربران می نماید.  

گونه های مختلف IRATA عموما خصوصیات مشترکی دارند:  

1.  در عموم موارد از **Firebase** به عنوان C2(*) استفاده می کنند (گاهی به صورت هیبریدی با یک C2 دیگر).
    
2.  در عموم موارد به دنبال دسترسی غیر مجاز به پیامک های کاربر هستند.
    
3.  در عموم موارد با ارسال مخفیانه پیامک از سیم کارت قربانی، به دنبال گسترش آلودگی خود هستند.
    
4.  در عموم موارد از طریق پیامک پخش می شوند.
    
5.  در عموم موارد C2 اختصاصی آن ها با PHP توسعه یافته و ساختار مشابهی دارد.
    
6.  در گونه هایی از IRATA از **basic4android** استفاده شده است.
    
_* گونه های جدیدتر و پیشرفته تر IRATA کمتر از این شیوه استفاده می کنند. این شیوه ارتباطی عموما مورد استفاده گونه های توسعه یافته با basic4android می باشد._  

نمونه های اولیه IRATA از اواخر دهه ۹۰ شمسی مشاهده شده اند. در طول زمان برخی از گونه های IRATA تغییرات و پیشرفت های قابل توجهی داشته اند.  

گونه های اولیه توسعه یافته با basic4android ساختار بسیار ساده ای داشته و همچنان در حال آلوده کردن کاربران می باشند. این گونه ها در طول زمان تغییرات کمتری را شاهد بوده اند و عموم کد منبع آن ها از پروژه های آموزشی ایرانی کپی شده است.  

عموم گونه های IRATA توسط پیامک پخش می شوند، دامنه های مورد استفاده آن ها عمر کوتاهی دارند و هر گونه شامل نمونه های بسیاری با قالب های متفاوت است؛ به همین دلایل کشف نمونه های مختلف این بدافزار ها امری مشکل است.  

با توجه به فراوانی و پراکندگی برخی از گونه های IRATA، خصوصا گونه های توسعه یافته با basic4android، گمان می رود کد منبع برخی از انواع این بدافزار به گروه های مجرم سایبری مختلف فروخته شده باشد.  
گزارش شده که گونه هایی از IRATA در سال ۲۰۲۴ میلادی به کاربران ایتالیایی نیز حمله کرده اند.  

**گونه هایی از IRATA که در حال حاضر توسط کاوه شناسایی می شوند:**

-   _[Android.Spy.Lydia](https://github.com/Nooshdaroo-Code/Kaveh/blob/main/docs/malware/Android.Spy.Lydia/README-fa.md)_

## منابع
- [https://malpedia.caad.fkie.fraunhofer.de/details/apk.irata](https://malpedia.caad.fkie.fraunhofer.de/details/apk.irata)
- [https://onecert.ir/portal/blog/irata](https://onecert.ir/portal/blog/irata)
- [https://www.telsy.com/en/mobile-device-security-focus-on-three-threats-to-android/](https://www.telsy.com/en/mobile-device-security-focus-on-three-threats-to-android/)
- [https://muha2xmad.github.io/malware-analysis/irata/](https://muha2xmad.github.io/malware-analysis/irata/)
- [https://virgool.io/@moh53n/%D9%81%DB%8C%D8%B4%DB%8C%D9%86%DA%AF-%D9%BE%DB%8C%D8%A7%D9%85%DA%A9%DB%8C-%D8%A8%D9%87-%D8%B3%D8%A8%DA%A9-%D9%87%D9%85%D8%AA%D8%A7-%D9%88-%D8%B9%D8%AF%D9%84-%D8%A7%DB%8C%D8%B1%D8%A7%D9%86-%D8%A8%D8%B1%D8%B1%D8%B3%DB%8C-%D8%A8%D8%AF%D8%A7%D9%81%D8%B2%D8%A7%D8%B1-%D9%81%DB%8C%D8%B4%DB%8C%D9%86%DA%AF-%D8%B1%D8%AC%DB%8C%D8%B3%D8%AA%D8%B1%DB%8C-%D8%AA%D9%84%D9%81%D9%86-%D9%87%D9%85%D8%B1%D8%A7%D9%87-myxky5fmtyor](https://virgool.io/@moh53n/%D9%81%DB%8C%D8%B4%DB%8C%D9%86%DA%AF-%D9%BE%DB%8C%D8%A7%D9%85%DA%A9%DB%8C-%D8%A8%D9%87-%D8%B3%D8%A8%DA%A9-%D9%87%D9%85%D8%AA%D8%A7-%D9%88-%D8%B9%D8%AF%D9%84-%D8%A7%DB%8C%D8%B1%D8%A7%D9%86-%D8%A8%D8%B1%D8%B1%D8%B3%DB%8C-%D8%A8%D8%AF%D8%A7%D9%81%D8%B2%D8%A7%D8%B1-%D9%81%DB%8C%D8%B4%DB%8C%D9%86%DA%AF-%D8%B1%D8%AC%DB%8C%D8%B3%D8%AA%D8%B1%DB%8C-%D8%AA%D9%84%D9%81%D9%86-%D9%87%D9%85%D8%B1%D8%A7%D9%87-myxky5fmtyor)