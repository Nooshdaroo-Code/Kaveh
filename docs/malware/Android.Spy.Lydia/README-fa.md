
# Android.Spy.Lydia


دسته بدافزار _Android.Spy.Lydia_ گونه ای از تروجان های ایرانی اندرویدی هستند که گاهی به عنوان یکی از گونه های [IRATA](https://github.com/Nooshdaroo-Code/Kaveh/blob/main/docs/malware/IRATA/README-fa.md) شناسایی می شوند. این بدافزار ها که از طریق پیامک هایی مانند ابلاغیه، یارانه، کالابرگ، همتا (رجیستری) و… کاربران را فریب می دهند، با اخذ دسترسی به پیامک های قربانی اقدام به دزدیدن رمز های بانکی و احراز هویت دو مرحله ای او می کنند.  


بدافزار های _Android.Spy.Lydia_ بخشی از حملات ترکیبی قیشینگ هستند. عموم نمونه های این بدافزار، در سه مرحله به شکل زیر کار می کنند:  

1.  **درگاه جعلی بانکی:** ابتدا یک درگاه بانکی جعلی را درون برنامه به قربانی نشان می دهند و اطلاعات کارت بانکی او (مانند شماره کارت، تاریخ انقضای کارت و CVV2) را ثبت می کنند. سپس یک خطای جعلی به کاربر نشان داده و از اون می خواهند بعدا تلاش کند. در این مرحله تراکنش بانکی صورت نمی گیرد.
    
2.  **سرقت پیامک:** مدتی بعد هکر با اطلاعات کارت بانکی قربانی اقدام به خرید یا انتقال وجه می کند و با استفاده از این بدافزار (که همچنان بر روی دستگاه قربانی فعال است)، پیامک رمز پویای بانکی او را از پیامک های وی به سرقت می برد.
    
3.  **گسترش آلودگی از طریق سیم کارت قربانی:** پس از انجام عملیات اصلی، هکر از طریق این بدافزار پیامک های فیشینگ مشابهی از سیم کارت قربانی ارسال می کند.
    

اگرچه هدف اصلی این تروجان سرقت پیامک های بانکی قربانی است، اما در بعضی نمونه ها نشانه هایی از بررسی وجود Trust Wallet، تلگرام، اینستاگرام و شاد بر روی دستگاه قربانی وجود دارد.  

این گونه بدافزار، یکی از اولین نمونه های تروجان بانکی ایرانی با این مکانیزم عملکرد است که از اواخر دهه ۹۰ شمسی (مدتی پس از اجباری شدن رمز پویا در ایران) مشاهده شده است. این دسته بدافزار با _basic4android_ توسعه یافته و ساختار بسیار ساده ای دارد. عموم کد منبع آن از پروژه های آموزشی ایرانی کپی شده است.


بیشتر نمونه های _Android.Spy.Lydia_ از Firebase به عنوان یکی از مسیر های C2 خود استفاده می کنند.