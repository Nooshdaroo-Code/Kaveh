
# Android.Spy.Lydia

The _Android.Spy.Lydia_ malware family consists of Iranian Android trojans that are sometimes classified as a variant of [IRATA](https://github.com/Nooshdaroo-Code/Kaveh/blob/main/docs/malware/IRATA/README.md). These malware samples trick users through SMS messages impersonating government services such as legal notifications, subsidies, Kalabarg, device registration (Hamta), and more. Once installed, they steal the victim’s banking credentials and two-factor authentication codes by accessing their SMS messages.  

برای نسخه فارسی این مستند، [اینجا کلیک کنید](https://github.com/Nooshdaroo-Code/Kaveh/blob/main/docs/malware/Android.Spy.Lydia/README-fa.md).  

_Android.Spy.Lydia_ malware is part of phishing-based hybrid attacks. Most samples operate in three main stages:  

1.  **Fake Banking Portal:** Initially, the malware displays a fake banking gateway within the app and prompts the victim to enter their card information (card number, expiration date, CVV2). It then shows a fake error and instructs the user to try again later. No transaction takes place at this stage.
    
2.  **Theft of SMS Code:** Later, the attacker uses the stolen banking details to make purchases or transfer money, and retrieves the victim’s one-time banking password (OTP) from their SMS using the malware, which remains active on the device.
    
3.  **Spread via Victim’s SIM Card:** After the attack, the malware sends similar phishing SMS messages to other users from the victim’s SIM card to propagate itself.
    

While the main purpose of this trojan is to steal banking SMS messages, some samples also check for the presence of apps like Trust Wallet, Telegram, Instagram, and Shad on the victim’s device.  

This malware family is one of the earliest Iranian banking trojans to use such a mechanism and has been observed since the early 2020s (after OTP banking passwords became mandatory in Iran). It is developed using _basic4android_ and has a very simple structure. Most of its code appears to be copied from Iranian educational projects.  

Most _Android.Spy.Lydia_ samples use Firebase as one of their C2 communication channels.  

## References
- [https://github.com/DoctorWebLtd/malware-iocs/blob/master/Android.Spy.Lydia/README.adoc](https://github.com/DoctorWebLtd/malware-iocs/blob/master/Android.Spy.Lydia/README.adoc)